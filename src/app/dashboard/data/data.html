<h1 class="text-center my-4">Alle Kurse</h1>
<div class="container-fluid px-0">
  <div class="row justify-content-center">
    <div class="col-12 col-md-10">
      <div class="table-responsive">
        <div class="table-container courses-table">
          <!-- Header Row -->
          <div class="row g-0 d-none d-md-flex">
            <div class="col-md-2 table-header fw-bold text-center p-3">Kurs</div>
            <div class="col-md-2 table-header fw-bold text-center p-3">Veranstaltungsort</div>
            <div class="col-md-2 table-header fw-bold text-center p-3">Adresse des Veranstaltungsortes</div>
            <div class="col-md-2 table-header fw-bold text-center p-3">Öffentlich erreichbar?</div>
            <div class="col-md-2 table-header fw-bold text-center p-3">Kursleiter</div>
            <div class="col-md-2 table-header fw-bold text-center p-3">Alle Termine</div>
          </div>

          <!-- Data Rows -->
          @for(course of store.courses; track $index) {
          <div class="row g-0 table-row">
            <div class="col-12 col-md-2 table-cell">
              <span class="mobile-label d-md-none fw-bold small text-secondary mb-1">Kurs:</span>
              <span class="table-value">{{ course.name }}</span>
            </div>
            <div class="col-12 col-md-2 table-cell">
              <span class="mobile-label d-md-none fw-bold small text-secondary mb-1">Veranstaltungsort:</span>
              <span class="table-value">{{ course.eventLocation.name }}</span>
            </div>
            <div class="col-12 col-md-2 table-cell">
              <span class="mobile-label d-md-none fw-bold small text-secondary mb-1">Adresse:</span>
              <span class="table-value">{{ course.eventLocation.address }}</span>
            </div>
            <div class="col-12 col-md-2 table-cell">
              <span class="mobile-label d-md-none fw-bold small text-secondary mb-1">Öffentlich erreichbar:</span>
              <span class="table-value">{{ course.eventLocation.venueByPublicTansport == true ? 'Ja' : 'Nein' }}</span>
            </div>
            <div class="col-12 col-md-2 table-cell">
              <span class="mobile-label d-md-none fw-bold small text-secondary mb-1">Kursleiter:</span>
              <span class="table-value">{{ course.instructor }}</span>
            </div>
            <div class="col-12 col-md-2 table-cell">
              <span class="mobile-label d-md-none fw-bold small text-secondary mb-1">Alle Termine:</span>
              <ul class="table-value mb-0">
                @for(date of course.dates; track $index) {
                <li>
                  <span>{{ date.begin | date : 'dd.MM.yyyy, HH:mm' }}</span> -
                  <span>{{ date.end | date : 'dd.MM.yyyy, HH:mm' }}</span>
                </li>
                }
              </ul>
            </div>
          </div>
          }
          @if (!store.isLoadingCourses && store.courses.length === 0) {
          <div class="no-data-message">
            Derzeit sind keine Kurse verfügbar.
          </div>
          }
        </div>
      </div>
    </div>
  </div>
</div>

<h1 class="text-center my-4">Alle Anmeldungen</h1>
<div class="container-fluid px-0">
  <div class="row justify-content-center">
    <div class="col-12 col-md-10">
      <div class="table-responsive">
        <div class="table-container registrations-table">
          <!-- Header Row -->
          <div class="row g-0 d-none d-md-flex">
            <div class="col-md-3 table-header fw-bold text-center p-3">Name</div>
            <div class="col-md-3 table-header fw-bold text-center p-3">Geburtsdatum</div>
            <div class="col-md-3 table-header fw-bold text-center p-3">Kurs</div>
            <div class="col-md-3 table-header fw-bold text-center p-3">Aktionen</div>
          </div>

          <!-- Data Rows -->
          @for (registration of paginatedRegistrations; track registration.id) {
          <div class="row g-0 table-row registration-row">
            @if (isDeleting(registration)) {
            <div class="registration-row-overlay">
              <div class="spinner row-spinner"></div>
            </div>
            }
            <div class="col-12 col-md-3 table-cell">
              <span class="mobile-label d-md-none fw-bold small text-secondary mb-1">Name:</span>
              <span class="table-value">{{ registration.name }}</span>
            </div>
            <div class="col-12 col-md-3 table-cell">
              <span class="mobile-label d-md-none fw-bold small text-secondary mb-1">Geburtsdatum:</span>
              <span class="table-value">{{ registration.birthdate | date : 'dd.MM.yyyy' }}</span>
            </div>
            <div class="col-12 col-md-3 table-cell">
              <span class="mobile-label d-md-none fw-bold small text-secondary mb-1">Kurs:</span>
              <span class="table-value">{{ registration.course?.name }}</span>
            </div>
            <div class="col-12 col-md-3 table-cell text-center">
              <span class="mobile-label d-md-none fw-bold small text-secondary mb-1">Aktionen:</span>
              <button
                class="btn btn-sm btn-danger"
                (click)="onDeleteRegistration(registration)"
                [disabled]="isDeleting(registration)"
              >
                Anmeldung löschen
              </button>
            </div>
          </div>
          }
          @if (!store.isLoadingRegistrations && store.registrations.length === 0) {
          <div class="no-data-message">
            Derzeit liegen keine Anmeldungen vor.
          </div>
          }
        </div>
        @if (store.registrations.length > registrationsPerPage) {
        <nav class="pagination-container" aria-label="Seiten für Anmeldungen">
          <button
            type="button"
            class="btn btn-outline-secondary btn-sm me-2"
            (click)="goToPreviousPage()"
            [disabled]="currentPage === 1"
          >
            Zurück
          </button>

          @for (page of pages; track page) {
          <button
            type="button"
            class="btn btn-sm me-1"
            [class.btn-primary]="currentPage === page"
            [class.btn-outline-primary]="currentPage !== page"
            (click)="goToPage(page)"
          >
            {{ page }}
          </button>
          }

          <button
            type="button"
            class="btn btn-outline-secondary btn-sm ms-2"
            (click)="goToNextPage()"
            [disabled]="currentPage === totalPages"
          >
            Weiter
          </button>

          <span class="pagination-info ms-3">
            Seite {{ currentPage }} von {{ totalPages }}
          </span>
        </nav>
        }
      </div>
    </div>
  </div>
</div>
